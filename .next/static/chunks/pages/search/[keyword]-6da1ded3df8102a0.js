(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[565],{2846:function(e,n,t){"use strict";t.d(n,{Z:function(){return N}});var r=t(6447),i=t(7294),o=t(8307),s=t(948),a=t(1796),c=t(8462),u=t(7212),l=t(8619),h=t(9334),d=t(8780),f=t(326),p=t(2293),x=t(7357),m=t(7533),g=t(155),v=t(5861),j=t(3156),Z=t(1057),w=t(7241),b=t(1163),_=t(5449),y=t(787),k=t(3946),C=t(2761),S=t(5893),P=(0,s.ZP)("div")(function(e){var n=e.theme;return(0,o.Z)({position:"relative",borderRadius:n.shape.borderRadius,backgroundColor:(0,a.Fq)(n.palette.common.white,.15),"&:hover":{backgroundColor:(0,a.Fq)(n.palette.common.white,.25)},marginRight:n.spacing(2),marginLeft:0,width:"100%"},n.breakpoints.up("sm"),{marginLeft:n.spacing(3),width:"auto"})}),E=(0,s.ZP)("div")(function(e){return{padding:e.theme.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}}),R=(0,s.ZP)(y.ZP)(function(e){var n=e.theme;return{color:"inherit","& .MuiInputBase-input":(0,o.Z)({padding:n.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(n.spacing(4),")"),transition:n.transitions.create("width"),width:"100%"},n.breakpoints.up("md"),{width:"20ch"})}}),q=[{name:"首页",path:"/"},{name:"文稿",path:"/articles"},{name:"音乐",path:"/music"},{name:"图库",path:"/gallery"}];function I(){var e=(0,b.useRouter)(),n=(0,i.useState)(""),t=n[0],o=n[1],s=(0,i.useState)(!1),a=s[0],y=s[1],I=function(){y(!a)},L=(0,S.jsx)(x.Z,{onClick:I,sx:{textAlign:"center"},children:(0,S.jsx)(c.Z,{children:q.map(function(e){return(0,S.jsx)(u.ZP,{disablePadding:!0,children:(0,S.jsx)(l.Z,{sx:{textAlign:"center"},href:e.path,target:"_blank",children:(0,S.jsx)(h.Z,{primary:e.name})})},e.name)})})});return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(p.Z,{position:"static",children:(0,S.jsx)(j.Z,{maxWidth:"xl",children:(0,S.jsxs)(g.Z,{disableGutters:!0,children:[(0,S.jsxs)(r.Z,{sx:{position:"relative",ml:1,transform:"translateY(4px)"},children:[(0,S.jsx)(d.Z,{sx:{width:20,position:"absolute",bottom:"50%",left:"50%",transform:"translateX(-50%)"}}),(0,S.jsx)(w.Z,{})]}),(0,S.jsx)(v.Z,{variant:"h6",noWrap:!0,component:"a",sx:{ml:1,mr:2,fontWeight:700,letterSpacing:".3rem",textDecoration:"none",cursor:"pointer"},style:{color:"white"},href:"/",onClick:function(){return e.push("/")},children:"和谐历史档案馆"}),(0,S.jsxs)(P,{sx:{display:{xs:"none",sm:"none",md:"flex",lg:"flex",xl:"flex"}},children:[(0,S.jsx)(E,{children:(0,S.jsx)(C.Z,{})}),(0,S.jsx)(R,{placeholder:"全站搜索",onKeyDown:function(n){if("Enter"===n.key){if("localhost"===location.hostname){e.push({pathname:"/search/[keyword]",query:{keyword:t}});return}window.open("https://www.google.com/search?q="+encodeURIComponent("site:banned-historical-archives.github.io "+t),"_blank")}},value:t,onChange:function(e){return o(e.target.value)},inputProps:{"aria-label":"search"}})]}),(0,S.jsx)(r.Z,{sx:{flex:1}}),(0,S.jsxs)(r.Z,{sx:{display:{xs:"none",sm:"flex"}},direction:"row",justifyContent:"flex-end",children:[q.map(function(n){var t=n.name,r=n.path;return(0,S.jsx)(Z.Z,{sx:{color:"white"},onClick:function(){return e.push(r)},children:t},r)}),(0,S.jsxs)(Z.Z,{href:"https://github.com/banned-historical-archives/banned-historical-archives.github.io/issues",target:"_blank",sx:{color:"white"},children:[(0,S.jsx)(_.Z,{sx:{mr:1}}),"讨论"]})]}),(0,S.jsx)(k.Z,{size:"small",edge:"start",color:"inherit","aria-label":"menu",sx:{display:{xs:"flex",sm:"none"}},onClick:I,children:(0,S.jsx)(f.Z,{})})]})})}),(0,S.jsx)(x.Z,{component:"nav",children:(0,S.jsx)(m.ZP,{variant:"temporary",anchor:"right",open:a,onClose:I,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:240}},children:L})})]})}function L(){return null}var M=t(8078);function N(e){var n=e.children,t=(0,i.useState)(!1),o=t[0],s=t[1],a=(0,b.useRouter)();return(0,i.useEffect)(function(){var e=function(e){s(!0)},n=function(){s(!1)};return a.events.on("routeChangeStart",e),a.events.on("routeChangeComplete",n),a.events.on("routeChangeError",n),function(){a.events.off("routeChangeStart",e),a.events.off("routeChangeComplete",n),a.events.off("routeChangeError",n)}},[a]),(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(r.Z,{sx:{position:"absolute",height:"100%",width:"100%"},direction:"column",children:[(0,S.jsx)(I,{}),o?(0,S.jsxs)(r.Z,{spacing:1,p:2,children:[(0,S.jsx)(M.Z,{variant:"text",sx:{fontSize:"1rem"}}),(0,S.jsx)(M.Z,{variant:"rectangular",height:60}),(0,S.jsx)(M.Z,{variant:"rectangular",height:60}),(0,S.jsx)(M.Z,{variant:"rectangular",height:60}),(0,S.jsx)(M.Z,{variant:"rectangular",height:60})]}):(0,S.jsx)("main",{style:{flex:1,position:"relative",overflow:"hidden"},children:n}),(0,S.jsx)(L,{})]})})}},9701:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return x}});var r=t(29),i=t(4687),o=t.n(i),s=t(7294),a=t(9008),c=t.n(a),u=t(1163),l=t(2846),h=t(1057),d=t(6447),f=t(5861),p=t(5893);function x(){var e=(0,s.useState)(10),n=e[0];e[1];var t=(0,s.useState)(0),i=t[0],a=t[1],l=(0,s.useState)(1),x=l[0],m=l[1],g=(0,s.useState)(),v=g[0],j=g[1],Z=(0,u.useRouter)().query.keyword;function w(){return(w=(0,r.Z)(o().mark(function e(n,t,r){var i;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:9200/article/_search/?source=".concat(encodeURIComponent(JSON.stringify({from:r,size:t,query:{match_phrase:{content:n}},highlight:{fields:{content:{}}}})),"&source_content_type=").concat(encodeURIComponent("application/json")));case 2:return e.next=4,e.sent.json();case 4:console.log(i=e.sent),j(i.hits);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}if((0,s.useEffect)(function(){!function(e,n,t){w.apply(this,arguments)}(Z,n,i)},[Z,n,i]),(0,s.useEffect)(function(){a(n*(x-1))},[x,n]),!v)return null;var b=Math.ceil(v.total.value/n);return(0,p.jsxs)(d.Z,{p:2,sx:{height:"100%",overflow:"scroll"},children:[(0,p.jsx)(c(),{children:(0,p.jsx)("title",{children:"和谐历史档案馆 Banned Historical Archives"})}),(0,p.jsxs)(f.Z,{variant:"h4",sx:{mb:1},children:["搜索:",Z]}),v.hits.map(function(e){return(0,p.jsxs)("div",{children:[(0,p.jsxs)("a",{href:"/articles/".concat(e._source.article_id,"?publication_id=").concat(e._source.publication_id),rel:"noreferrer",target:"_blank",children:[e._source.title,"-",e._source.publication_name]}),e.highlight.content.map(function(e){return(0,p.jsx)("div",{style:{marginLeft:20,fontSize:8},dangerouslySetInnerHTML:{__html:e}},e)})]},e._id)}),(0,p.jsxs)("div",{children:[(0,p.jsx)(h.Z,{onClick:function(){x>1&&m(x-1)},children:"上一页"}),x,"/",b,(0,p.jsx)(h.Z,{onClick:function(){x<b&&m(x+1)},children:"下一页"})]})]})}x.getLayout=function(e){return(0,p.jsx)(l.Z,{children:e})}},6532:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/search/[keyword]",function(){return t(9701)}])},29:function(e,n,t){"use strict";function r(e,n,t,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){t(e);return}a.done?n(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var n=this,t=arguments;return new Promise(function(i,o){var s=e.apply(n,t);function a(e){r(s,i,o,a,c,"next",e)}function c(e){r(s,i,o,a,c,"throw",e)}a(void 0)})}}t.d(n,{Z:function(){return i}})}},function(e){e.O(0,[738,774,888,179],function(){return e(e.s=6532)}),_N_E=e.O()}]);